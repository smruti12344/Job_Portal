package com.DAO;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import com.Bean.*;
import com.DB.*;
public class ViewJobDAO {
	
		public ArrayList<JobBean> al = new ArrayList<JobBean>();
	public ArrayList<JobBean> retrive(){
		
		try {
			//load db-connection
			Connection con = DBConnection.getCon();
			//prepare queries to retrived data from db
			PreparedStatement ps = con.prepareStatement("select * from job order by id desc");
			
			
			ResultSet rs = ps.executeQuery();
			while(rs.next()) {
				//ProductBean-obj
				JobBean job = new JobBean();
				//set data from ps to job
				job.setTitle(null);
				pb.setpName(rs.getString(2));
				pb.setpPrice(rs.getFloat(3));
				pb.setpQty(rs.getInt(4));
				al.add(pb);//adding product to al
			}//end of loop
			//add pb to arr-obj
			
			
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return al;
	}
	}


